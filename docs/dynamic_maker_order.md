# 动态Maker订单功能说明文档

## 概述

动态Maker订单功能是对基础Maker订单的智能增强，通过根据信号强度和市场波动率自动调整订单参数，实现更高的成交率和更优的交易执行。

**核心优势：**
- 🎯 智能过滤：弱信号直接用市价单，避免浪费时间
- 📊 波动率自适应：高波动快速决策，低波动耐心等待
- ⚡ 动态参数：根据市场状态自动调整超时和价格偏移
- 🛡️ 极端保护：极端波动时强制使用市价单
- 💰 成本优化：在保证成交的前提下最大化手续费节省

## 功能特性

### 1. 信号强度过滤

**工作原理：**
- 信号强度 < 0.6：直接使用市价单（弱信号不值得等待）
- 信号强度 0.6-0.8：使用Maker订单，标准参数
- 信号强度 > 0.8：使用Maker订单，延长超时（强信号值得等待）

**优势：**
- 避免弱信号浪费等待时间
- 强信号获得更多成交机会
- 提高整体交易效率

### 2. 波动率自适应

**三档波动率策略：**

| 波动率 | 超时时间 | 价格偏移 | 策略说明 |
|--------|---------|---------|---------|
| 低波动 (< 1%) | 15秒 | 0.005% | 耐心等待，追求最优价格 |
| 正常波动 (1%-6%) | 10秒 | 0.01% | 标准参数，平衡成交率 |
| 高波动 (6%-8%) | 5秒 | 0.02% | 快速决策，提高成交率 |
| 极端波动 (> 8%) | 0秒 | - | 强制市价单，避免错过 |

### 3. 动态参数计算

**超时时间调整：**
```
基础超时 = 10秒

高波动：5秒（快速决策）
低波动：15秒（耐心等待）
强信号（>0.8）：基础超时 × 1.2
中等信号（<0.7）：基础超时 × 0.8
```

**价格偏移调整：**
```
基础偏移 = 0.01%

高波动：0.02%（增大偏移提高成交率）
低波动：0.005%（减小偏移降低滑点）
```

### 4. 极端波动保护

**触发条件：**
- 波动率 > 8%（极端波动阈值）
- 启用 `MAKER_DISABLE_ON_EXTREME_VOL = True`

**保护措施：**
- 强制使用市价单
- 避免在剧烈波动中错过交易机会
- 防止限价单长时间未成交

## 配置说明

### 配置文件位置
`/root/trading_bot/config.py`

### 配置项详解

```python
# ==================== 动态Maker订单配置 ====================

# 是否启用动态Maker订单（根据信号强度和波动率自适应）
ENABLE_DYNAMIC_MAKER = True  # True: 启用动态调整，False: 使用固定参数

# 信号强度阈值
MAKER_MIN_SIGNAL_STRENGTH = 0.6  # 低于此值直接使用市价单
MAKER_OPTIMAL_SIGNAL_STRENGTH = 0.8  # 高于此值使用最优参数

# 波动率自适应参数
MAKER_HIGH_VOL_TIMEOUT = 5  # 高波动超时（秒）
MAKER_LOW_VOL_TIMEOUT = 15  # 低波动超时（秒）
MAKER_HIGH_VOL_OFFSET = 0.0002  # 高波动偏移（0.02%）
MAKER_LOW_VOL_OFFSET = 0.00005  # 低波动偏移（0.005%）

# 极端波动禁用Maker订单
MAKER_DISABLE_ON_EXTREME_VOL = True  # 极端波动时强制使用市价单
MAKER_EXTREME_VOL_THRESHOLD = 0.08  # 极端波动阈值（8%）
```

### 配置参数说明

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| ENABLE_DYNAMIC_MAKER | bool | True | 是否启用动态Maker订单 |
| MAKER_MIN_SIGNAL_STRENGTH | float | 0.6 | 最小信号强度阈值 |
| MAKER_OPTIMAL_SIGNAL_STRENGTH | float | 0.8 | 最优信号强度阈值 |
| MAKER_HIGH_VOL_TIMEOUT | int | 5 | 高波动超时（秒） |
| MAKER_LOW_VOL_TIMEOUT | int | 15 | 低波动超时（秒） |
| MAKER_HIGH_VOL_OFFSET | float | 0.0002 | 高波动价格偏移 |
| MAKER_LOW_VOL_OFFSET | float | 0.00005 | 低波动价格偏移 |
| MAKER_DISABLE_ON_EXTREME_VOL | bool | True | 极端波动禁用开关 |
| MAKER_EXTREME_VOL_THRESHOLD | float | 0.08 | 极端波动阈值（8%） |
