# Trading Bot 架构优化与前端增强 - 实施计划

**文档版本**: v1.0
**创建时间**: 2026-01-13
**方案定位**: 方案1 - 轻量化重构 + 前端增强
**批准状态**: ✅ 已批准

---

## 1. 计划概览

### 1.1 核心目标

1. **降低后端耦合度**：解决 `bot.py` God Object 问题，统一交易所层
2. **提升前端体验**：引入 WebSocket 实时推送，可视化配置界面
3. **增强 AI 集成**：深度集成 Claude 分析，智能导师模块
4. **改善可维护性**：配置分层治理，测试体系化

### 1.2 预期收益

- 代码可维护性提升 40%
- 用户体验延迟降低 80%（WebSocket）
- 配置错误率降低 60%（可视化校验）
- 测试覆盖率提升至 70%+

### 1.3 项目背景

**当前问题**：
- `bot.py` 是 God Object，耦合度高
- `LegacyAdapter` 与 `exchange/` 双栈并存
- 配置层复杂，全局状态扩散
- 前端轮询机制导致延迟
- 缺乏可视化配置界面
- AI 分析未深度集成

**解决方案**：
- 保持单体架构但模块解耦
- 统一交易所适配层
- 配置分层治理
- 引入 WebSocket 实时推送
- 可视化配置界面
- AI 智能导师模块

---

## 2. 后端实施计划（Codex 规划）

### 2.1 架构重构方案

#### 2.1.1 TradingEngine 接口

统一编排入口，分层为四个引擎：

- **StrategyEngine**（策略层）
  - 职责：策略加载、信号生成、共识计算
  - 接口：`generate_signal(df) -> TradeSignal`

- **RiskEngine**（风控层）
  - 职责：仓位管理、止损止盈、回撤控制
  - 接口：`can_open_position() -> (bool, str)`

- **ExecutionEngine**（执行层）
  - 职责：订单执行、交易所交互、流动性验证
  - 接口：`execute_order(signal) -> OrderResult`

- **MonitoringEngine**（监控层）
  - 职责：状态监控、日志记录、通知推送
  - 接口：`update_status(event) -> None`

#### 2.1.2 交易所层统一

**目标**：仅保留 `exchange/` 适配体系

**实施步骤**：
1. 确认 `ExchangeInterface` 接口完整性
2. 补齐 `ExchangeManager` 生命周期管理
3. 将 `trader.py` 改为基于 `ExchangeInterface`
4. 逐步替换 `LegacyAdapter` 调用
5. 完成迁移后删除 `exchange/legacy_adapter.py`

**接口定义**：
```python
class ExchangeInterface:
    def connect() -> bool
    def disconnect() -> None
    def get_ticker(symbol) -> TickerData
    def get_klines(symbol, timeframe, limit) -> pd.DataFrame
    def get_balance() -> float
    def get_positions() -> List[PositionData]
    def open_long(amount, df) -> OrderResult
    def open_short(amount, df) -> OrderResult
    def close_position(reason) -> bool
    def set_leverage(leverage) -> None
    def set_margin_mode(mode) -> None
```

#### 2.1.3 配置分层治理

**目标**：将配置拆分到 `config/` 子模块

**新结构**：
```
config/
├── __init__.py          # 统一导出接口
├── runtime.py           # 运行时配置（日志、数据库、API）
├── strategies.py        # 策略配置（启用策略、参数）
├── ai.py                # AI 配置（Claude、ML）
├── risk.py              # 风控配置（止损、仓位）
└── exchanges.py         # 交易所配置（API Key、杠杆）
```

**迁移策略**：
- `config.py` 保留兼容层，逐步标注废弃
- 新代码使用 `from config.strategies import ENABLE_STRATEGIES`
- 旧代码继续使用 `import config; config.ENABLE_STRATEGIES`

#### 2.1.4 测试体系化

**目标**：迁移到 `pytest` 框架

**测试结构**：
```
tests/
├── conftest.py          # pytest 配置和 fixtures
├── unit/                # 单元测试
│   ├── test_strategies.py
│   ├── test_risk_manager.py
│   └── test_indicators.py
├── integration/         # 集成测试
│   ├── test_trading_flow.py
│   └── test_exchange_adapters.py
└── regression/          # 回归测试
    └── test_backtest_consistency.py
```

**核心回归测试集**：
1. 策略信号生成一致性
2. 风控规则触发准确性
3. 交易执行流程完整性
4. 交易所适配器功能性

---

### 2.2 关键文件变更清单

#### 2.2.1 修改文件

| 文件 | 变更内容 | 优先级 |
|------|---------|--------|
| `bot.py` | 迁移为 `TradingEngine` 编排器，减少直接依赖 | P0 |
| `trader.py` | 改为基于 `ExchangeInterface` 的执行层 | P0 |
| `exchange/manager.py` | 补齐标准化接口与生命周期契约 | P0 |
| `exchange/interface.py` | 完善接口定义 | P0 |
| `config/__init__.py` | 统一导出接口 | P1 |
| `config/*.py` | 清理动态导入与隐式依赖 | P1 |
| `logger_utils.py` | 日志/DB 访问入口收敛与边界声明 | P2 |

#### 2.2.2 新增文件

| 文件 | 内容 | 优先级 |
|------|------|--------|
| `core/engine.py` | TradingEngine 实现与分层初始化 | P0 |
| `core/contracts.py` | 策略/风控/执行接口定义 | P0 |
| `tests/conftest.py` | pytest 配置和 fixtures | P1 |
| `tests/unit/` | 单元测试目录 | P1 |
| `tests/integration/` | 集成测试目录 | P1 |

#### 2.2.3 删除文件

| 文件 | 删除时机 | 备注 |
|------|---------|------|
| `exchange/legacy_adapter.py` | 完成迁移后移除 | 需确保所有调用已迁移 |

---

### 2.3 实施步骤（6个阶段）

#### 阶段0：骨架与接口（3天）

**任务**：
1. 定义 `TradingEngine` 与分层接口（策略/风控/执行/监控）
2. 创建 `core/engine.py` 和 `core/contracts.py`
3. 引入 `pytest` 与最小测试框架骨架
4. 创建 `tests/` 目录结构

**交付物**：
- `core/contracts.py`：接口定义
- `tests/conftest.py`：pytest 配置
- 文档：接口设计说明

**验证标准**：
- 接口定义通过代码审查
- pytest 框架可正常运行

---

#### 阶段1：编排解耦（5天）

**任务**：
1. 将 `bot.py` 初始化流程迁移至 `core/engine.py`
2. 通过依赖注入连接策略、风控、执行与监控模块
3. 保留 `bot.py` 作为兼容入口
4. 编写 `TradingEngine` 单元测试

**交付物**：
- `core/engine.py`：TradingEngine 实现
- `tests/unit/test_engine.py`：单元测试
- 迁移文档

**验证标准**：
- 新旧入口功能一致
- 单元测试覆盖率 > 80%
- 回测结果一致

---

#### 阶段2：交易所层统一（5天）

**任务**：
1. 以 `exchange/` 为唯一入口改造执行层
2. 将 `trader.py` 改为基于 `ExchangeInterface`
3. 逐步替换 `LegacyAdapter` 调用
4. 补齐交易所适配器测试

**交付物**：
- 改造后的 `trader.py`
- `tests/integration/test_exchange_adapters.py`
- 迁移进度报告

**验证标准**：
- 所有交易所适配器通过测试
- 实盘模拟运行 24 小时无异常
- `LegacyAdapter` 调用清零

---

#### 阶段3：配置分层治理（4天）

**任务**：
1. 拆分运行时/策略/AI/风控配置到 `config/`
2. `config.py` 仅保留兼容映射并标注废弃路径
3. 更新所有模块的配置导入
4. 编写配置验证测试

**交付物**：
- `config/` 子模块
- 配置迁移脚本
- 配置文档

**验证标准**：
- 新旧配置方式均可用
- 配置验证测试通过
- 无配置相关错误

---

#### 阶段4：测试体系化（5天）

**任务**：
1. 将 `scripts/test_*.py` 迁移为 `pytest` 用例
2. 建立最小回归集
3. 接入 CI（若有）
4. 补齐核心路径测试

**交付物**：
- 完整的 `tests/` 目录
- CI 配置文件
- 测试覆盖率报告

**验证标准**：
- 测试覆盖率 > 70%
- 核心回归测试通过
- CI 流程正常运行

---

#### 阶段5：观测与稳定性（3天）

**任务**：
1. 统一日志/DB 访问服务，划分读写职责
2. 增加关键路径指标与错误边界日志
3. 完善监控告警
4. 压力测试与稳定性验证

**交付物**：
- 统一的日志/DB 服务
- 监控指标文档
- 压力测试报告

**验证标准**：
- 日志/DB 访问路径统一
- 关键指标可观测
- 连续运行 72 小时无异常

---

### 2.4 风险点与缓解措施

| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|---------|
| **行为回归风险** | 中 | 高 | 保留影子模式/回测模式；使用特性开关分批切换 |
| **交易所适配不一致** | 中 | 中 | 补齐适配器一致性测试与模拟环境验证 |
| **配置迁移破坏** | 中 | 中 | 提供兼容层与弃用提示，分阶段迁移 |
| **测试覆盖不足** | 中 | 高 | 优先覆盖资金安全相关路径（下单/风控/止损） |

### 2.5 验证方案

#### 2.5.1 功能验证
- `pytest` 回归 + 既有脚本对照验证
- 保留兼容运行入口

#### 2.5.2 策略一致性
- 回测结果与信号数量对比
- 关键 KPI：胜率/回撤/盈亏比

#### 2.5.3 稳定性验证
- 连续运行与错误退避路径压测
- 检查日志与 DB 完整性

#### 2.5.4 灰度验证
1. 先开启影子模式
2. 再逐步切换为执行模式

---

## 3. 前端实施计划（Gemini 规划）

### 3.1 UI/UX 设计方案

#### 3.1.1 布局策略："Bento Box"（便当盒）布局

**Side Navigation**（侧边导航）：
- 实时概览（Dashboard）
- 策略配置（Strategy Config）
- AI 智库（AI Insights）
- 交易历史（Trade History）

**Top Header**（顶部栏）：
- 机器人开关（Bot On/Off）
- 心跳延迟（Heartbeat Latency）
- API 连通性（API Status）
- 暗黑模式切换（Dark Mode Toggle）

**Main Dashboard**（主面板）：
- **中心区**：高性能 K 线图 + 实时 PnL 曲线
- **右侧栏**：AI 实时决策流（"智能导师"）
- **底部栏**：滚动成交记录与活跃委托单

#### 3.1.2 组件设计

**Status Badges**（状态徽章）：
- 呼吸灯效果展示 WebSocket 状态
- 颜色编码：绿色（连接）、黄色（重连中）、红色（断开）

**Actionable Cards**（可操作卡片）：
- AI 建议以卡片形式呈现
- 支持一键点击执行建议的操作
- 显示信心指数和风险评估

**Data Visualization**（数据可视化）：
- K 线图：Lightweight Charts（TradingView）
- PnL 曲线：实时更新，支持缩放和平移
- 统计图表：Recharts 或 VisX

---

### 3.2 技术实现方案

#### 3.2.1 WebSocket 实时通信

**库选型**：
- 前端：`Socket.io-client`
- 后端：FastAPI + `python-socketio`

**数据流设计**：

订阅三个主要频道：

1. **market_data**（市场数据）
   - 价格跳动
   - 订单簿更新
   - 成交量变化

2. **order_events**（订单事件）
   - 订单成交
   - 订单取消
   - 持仓变化

3. **bot_log**（系统日志）
   - 策略信号
   - 风控触发
   - 异常告警

**连接管理**：
```typescript
// 自动重连机制
const socket = io(WS_URL, {
  reconnection: true,
  reconnectionDelay: 1000,
  reconnectionAttempts: 5
});

// 心跳检测
socket.on('connect', () => {
  setInterval(() => {
    socket.emit('ping');
  }, 30000);
});

// 降级轮询
socket.on('disconnect', () => {
  startPolling(); // 降级到 HTTP 轮询
});
```

#### 3.2.2 可视化配置界面

**核心逻辑**：
- 使用 `react-hook-form` 进行表单管理
- 使用 `Zod` 进行 Schema 验证
- 后端暴露 `config_schema.json`

**动态渲染**：
```typescript
// 后端返回的 Schema
{
  "STOP_LOSS_PERCENT": {
    "type": "number",
    "min": 0.005,
    "max": 0.05,
    "default": 0.045,
    "description": "止损比例"
  }
}

// 前端自动生成表单
<FormField
  name="STOP_LOSS_PERCENT"
  type="slider"
  min={0.005}
  max={0.05}
  step={0.001}
  defaultValue={0.045}
/>
```

**配置热更新**：
1. 用户在前端修改配置
2. Zod 验证通过
3. 通过 WebSocket 推送到后端
4. 后端验证并应用配置
5. 返回确认消息

#### 3.2.3 高性能图表选型

**K 线图**：
- 库：**Lightweight Charts (TradingView)**
- 特点：Canvas 驱动，专为交易数据设计
- 性能：可流畅渲染 10000+ 数据点

**统计图表**：
- 库：**Recharts** 或 **VisX**
- 用途：资产分布、策略对比、收益曲线

**性能优化**：
- 使用 `requestAnimationFrame` 节流
- 仅渲染可视区域数据
- 支持虚拟滚动

#### 3.2.4 AI 深度集成

**流式响应**：
- 模仿 ChatGPT 的流式输出（Streaming UI）
- 展示 Claude 的推理过程
- 实时显示分析进度

**情感反馈**：
- 根据 AI 信心指数展示不同色彩
- 强烈看涨：深绿脉冲效果
- 中性：灰色
- 强烈看跌：深红脉冲效果

**智能导师模块**：
```typescript
<AIInsightCard>
  <Icon type={getIconByConfidence(confidence)} />
  <Title>市场分析</Title>
  <Content>
    由于当前市场进入高波动状态，
    策略已自动收紧止损线至 3.5%
  </Content>
  <Actions>
    <Button>查看详情</Button>
    <Button>应用建议</Button>
  </Actions>
</AIInsightCard>
```

---

### 3.3 实施步骤（4个阶段）

#### Phase 1：实时基础（1周）

**任务**：
1. 集成 WebSocket 服务
2. 实现暗黑模式基础框架
3. 建立数据总线

**具体工作**：
- 后端：在 `apps/api` 中集成 `python-socketio`
- 前端：安装 `socket.io-client` 并建立连接
- 实现三个频道的订阅机制
- 开发暗黑模式切换组件
- 建立全局状态管理（Zustand）

**交付物**：
- 实时价格跳动的 Dashboard
- WebSocket 连接状态监控
- 暗黑模式切换功能

**验证标准**：
- WebSocket 连接稳定（断线自动重连）
- 价格更新延迟 < 100ms
- 暗黑模式切换流畅

---

#### Phase 2：配置管理（1周）

**任务**：
1. 开发可视化配置页面
2. 集成 Zod 校验
3. 实现配置热更新下发

**具体工作**：
- 后端：暴露 `config_schema.json` API
- 前端：使用 `react-hook-form` + `Zod` 构建表单
- 实现动态表单渲染逻辑
- 开发配置历史对比功能
- 实现配置回滚机制

**交付物**：
- 零代码参数调整界面
- 配置验证与错误提示
- 配置历史记录

**验证标准**：
- 所有配置项可视化编辑
- 验证规则生效
- 配置热更新成功率 100%

---

#### Phase 3：AI 导师（1周）

**任务**：
1. 接入 AI 分析流数据
2. 开发"智能导师"侧边栏
3. 实现自然语言提示

**具体工作**：
- 后端：通过 WebSocket 推送 Claude 分析结果
- 前端：开发 AI 洞察卡片组件
- 实现流式响应 UI
- 开发情感反馈动画
- 集成一键执行建议功能

**交付物**：
- 策略洞察展示模块
- AI 建议卡片
- 流式分析展示

**验证标准**：
- AI 分析实时展示
- 流式输出流畅
- 建议可一键执行

---

#### Phase 4：性能优化（0.5周）

**任务**：
1. 实施大列表虚拟化
2. 图表性能压测
3. 完善 Accessibility

**具体工作**：
- 使用 `react-window` 优化交易历史列表
- 图表渲染性能测试与优化
- 实现快捷键支持（`Cmd+K` 命令面板）
- WCAG 2.1 可访问性审计
- 性能监控与优化

**交付物**：
- 高流畅度量化终端
- 性能测试报告
- 可访问性审计报告

**验证标准**：
- 列表滚动 FPS > 55
- 图表渲染延迟 < 16ms
- 通过 WCAG 2.1 AA 级标准

---

### 3.4 用户体验优化点

#### 3.4.1 实时交互反馈
- 价格变动时数值背景闪烁（绿涨红跌）
- 订单成交时播放提示音（可配置）
- 持仓盈亏实时更新，颜色编码

#### 3.4.2 配置回滚（Safety）
- 历史配置对比功能
- 一键回滚到 24 小时前的参数
- 配置变更日志记录

#### 3.4.3 异常警报
- 触发 Circuit Breaker 时全屏边缘泛红警示
- AI 导师直接置顶显示"熔断原因"与"应对建议"
- 紧急停止按钮（大红按钮）

#### 3.4.4 智能提示
- 新手引导（首次使用）
- 操作提示（Tooltip）
- 错误提示（友好的错误信息）

---

### 3.5 性能与可访问性

#### 3.5.1 性能优化

**Virtualized Lists**：
- 使用 `react-window` 仅渲染可视区域
- 防止成千上万条记录造成浏览器崩溃
- 支持动态高度和滚动优化

**Data Throttling**：
- 针对 WebSocket 高频推送，实施 `requestAnimationFrame` 节流
- 确保 UI 更新频率不超过屏幕刷新率（60 FPS）
- 批量更新状态，减少重渲染

**Code Splitting**：
- 路由级代码分割
- 组件懒加载
- 减少首屏加载时间

#### 3.5.2 可访问性（a11y）

**高对比度**：
- 暗黑模式下严格遵循 WCAG 2.1 标准
- 确保红色与绿色文字在深色背景下有足够的对比度
- 支持系统级高对比度模式

**快捷键**：
- `Cmd+K`：快速唤起命令面板
- `Space`：暂停/恢复机器人
- `Esc`：关闭弹窗
- `?`：显示快捷键帮助

**屏幕阅读器支持**：
- 语义化 HTML
- ARIA 标签
- 焦点管理

---

## 4. 整体实施路线图与风险管理

### 4.1 前后端协同路线图

#### 4.1.1 并行开发策略

```
时间轴 | 后端（Codex）                  | 前端（Gemini）
-------|-------------------------------|---------------------------
Week 1 | 阶段0-1：接口定义+编排解耦      | Phase 1：WebSocket+暗黑模式
Week 2 | 阶段2：交易所层统一            | Phase 2：可视化配置界面
Week 3 | 阶段3：配置分层治理            | Phase 3：AI 智能导师集成
Week 4 | 阶段4-5：测试+观测稳定性       | Phase 4：性能优化+压测
```

#### 4.1.2 关键里程碑

| 里程碑 | 时间点 | 交付物 | 验收标准 |
|--------|--------|--------|---------|
| **M1** | Week 1 结束 | WebSocket 实时推送可用 | 延迟 < 100ms，自动重连 |
| **M2** | Week 2 结束 | 可视化配置界面上线 | 所有配置项可编辑 |
| **M3** | Week 3 结束 | 后端架构解耦完成 | 测试覆盖率 > 70% |
| **M4** | Week 4 结束 | 完整系统集成测试通过 | 连续运行 72 小时无异常 |

#### 4.1.3 依赖关系

**前端依赖后端**：
- Phase 1 依赖后端 WebSocket 服务
- Phase 2 依赖后端 `config_schema.json` API
- Phase 3 依赖后端 AI 分析流数据

**后端独立开发**：
- 阶段0-3 可独立进行
- 阶段4-5 需要前端配合测试

---

### 4.2 风险管理矩阵

#### 4.2.1 技术风险

| 风险类型 | 概率 | 影响 | 缓解措施 | 责任人 |
|---------|------|------|---------|--------|
| **行为回归** | 中 | 高 | 保留影子模式，特性开关分批切换 | 后端团队 |
| **WebSocket 断连** | 高 | 中 | 自动重连+心跳检测+降级轮询 | 前端团队 |
| **配置迁移破坏** | 中 | 中 | 提供兼容层，分阶段迁移 | 后端团队 |
| **前端性能瓶颈** | 低 | 中 | 虚拟化列表+Canvas渲染 | 前端团队 |
| **测试覆盖不足** | 中 | 高 | 优先覆盖资金安全路径 | 测试团队 |
| **交易所适配不一致** | 中 | 中 | 补齐适配器一致性测试 | 后端团队 |

#### 4.2.2 业务风险

| 风险类型 | 概率 | 影响 | 缓解措施 |
|---------|------|------|---------|
| **实盘交易中断** | 低 | 高 | 灰度发布，保留回滚机制 |
| **配置错误导致亏损** | 中 | 高 | 配置验证+历史回滚 |
| **用户学习成本高** | 中 | 低 | 新手引导+操作提示 |

#### 4.2.3 进度风险

| 风险类型 | 概率 | 影响 | 缓解措施 |
|---------|------|------|---------|
| **开发延期** | 中 | 中 | 预留 20% 缓冲时间 |
| **测试不充分** | 中 | 高 | 提前介入测试，持续集成 |
| **资源不足** | 低 | 中 | 优先级排序，聚焦核心功能 |

---

### 4.3 验证与回滚策略

#### 4.3.1 功能验证

**后端验证**：
- `pytest` 回归测试
- 既有脚本对照验证
- 回测结果对比（胜率/回撤/盈亏比）
- 连续运行与错误退避压测

**前端验证**：
- 单元测试（Jest + React Testing Library）
- E2E 测试（Playwright）
- 性能测试（Lighthouse）
- 可访问性测试（axe-core）

#### 4.3.2 灰度发布策略

**阶段1：影子模式（3天）**
- 新代码运行但不影响实盘
- 记录所有决策和结果
- 对比新旧系统差异

**阶段2：小流量测试（3天）**
- 10% 流量切换到新系统
- 使用小仓位测试
- 密切监控异常

**阶段3：中流量测试（3天）**
- 50% 流量切换
- 正常仓位测试
- 性能监控

**阶段4：全量上线（持续）**
- 100% 流量切换
- 持续监控
- 定期回顾

#### 4.3.3 回滚机制

**代码回滚**：
- 保留旧版本代码分支（`backup/pre-refactor`）
- Git tag 标记关键版本
- 一键回滚脚本

**配置回滚**：
- 配置文件版本控制
- 历史配置快照
- 前端一键回滚按钮

**数据回滚**：
- 数据库备份（每日）
- 关键表快照
- 数据恢复脚本

**回滚触发条件**：
- 测试覆盖率下降 > 10%
- 回测结果差异 > 5%
- 实盘异常率 > 1%
- 用户反馈严重问题

---

## 5. 总结与下一步

### 5.1 核心价值

本实施计划通过"轻量化重构 + 前端增强"策略，在保持系统稳定性的前提下，实现了：

1. **架构优化**：降低耦合度，提升可维护性
2. **用户体验提升**：实时推送、可视化配置、AI 智能导师
3. **风险可控**：灰度发布、回滚机制、完善测试
4. **成本效益**：投入产出比最优，4周完成核心改造

### 5.2 预期成果

**技术指标**：
- 代码可维护性提升 40%
- 测试覆盖率提升至 70%+
- 前端响应延迟降低 80%

**业务指标**：
- 配置错误率降低 60%
- 用户操作效率提升 50%
- 系统稳定性提升 30%

### 5.3 下一步行动

#### 立即执行（本周）：
1. ✅ 用户批准实施计划
2. 🔄 创建项目分支（`feature/refactor-v1`）
3. 🔄 搭建开发环境
4. 🔄 启动阶段0和Phase 1

#### 短期目标（Week 1-2）：
- 完成后端接口定义和编排解耦
- 完成前端 WebSocket 集成和暗黑模式
- 完成可视化配置界面

#### 中期目标（Week 3-4）：
- 完成后端配置分层治理和测试体系化
- 完成前端 AI 智能导师集成和性能优化
- 完成系统集成测试

#### 长期目标（Week 5+）：
- 灰度发布和全量上线
- 持续监控和优化
- 收集用户反馈并迭代

---

## 6. 附录

### 6.1 参考资料

**后端技术文档**：
- [Python 依赖注入最佳实践](https://python-dependency-injector.ets-labs.org/)
- [pytest 测试框架文档](https://docs.pytest.org/)
- [FastAPI WebSocket 文档](https://fastapi.tiangolo.com/advanced/websockets/)

**前端技术文档**：
- [Socket.io-client 文档](https://socket.io/docs/v4/client-api/)
- [Lightweight Charts 文档](https://tradingview.github.io/lightweight-charts/)
- [React Hook Form 文档](https://react-hook-form.com/)
- [Zod 文档](https://zod.dev/)

**设计参考**：
- [shadcn/ui 组件库](https://ui.shadcn.com/)
- [WCAG 2.1 可访问性标准](https://www.w3.org/WAI/WCAG21/quickref/)

### 6.2 关键决策记录

| 决策 | 理由 | 日期 |
|------|------|------|
| 采用方案1（轻量化重构） | 风险可控，成本效益最优 | 2026-01-13 |
| 使用 Lightweight Charts | 性能最优，专为交易设计 | 2026-01-13 |
| 使用 Socket.io | 成熟稳定，自动重连 | 2026-01-13 |
| 使用 pytest | Python 标准测试框架 | 2026-01-13 |

### 6.3 会话记录

**Codex 会话 ID**: `019bb66a-c92d-7272-92b6-07296dba90a2`
**Gemini 会话 ID**: `9adf5c80-282a-491b-8ce5-42f400f25f3b`

---

**文档状态**: ✅ 已完成
**批准状态**: ✅ 已批准
**下一步**: 进入阶段4（实施）

---

*本文档由 Claude Code 多模型协作工作流生成*
*Codex（后端架构）+ Gemini（前端体验）+ Claude（编排整合）*

